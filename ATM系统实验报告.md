# ATM系统实验报告

## 1. 需求分析

### 1.1 项目目标
设计一个简单的ATM系统，模拟现实生活中银行ATM的基本功能。

- **用户认证**：登录时验证身份，防止他人乱用
- **账户操作**：能查余额、存钱、取钱、转账
- **安全管理**：密码输错几次就锁账户，避免暴力破解
- **交易记录**：保留每次操作的记录，方便查询

### 1.2 数据处理
在开发过程中发现需要处理的数据主要有：
- 用户信息：账号、姓名、身份证、密码、余额
- 交易信息：类型、金额、时间、对方账号
- 状态管理：账户是否锁定、密码错误次数

### 1.3 数据存储
考虑到简单易用，决定用文本文件存储数据：
- 用CSV格式存储用户信息，方便读写
- 密码加密后保存，不能直接看到原密码
- 每次启动程序时从文件加载数据，关闭时保存到文件

### 1.4 功能规划
最终确定的功能包括：
- 用户注册和登录
- 基本业务：存款、取款、转账
- 其他功能：改密码、挂失/解挂、看交易记录

## 2. 系统设计

### 2.1 模块划分
在编写代码前，把整个系统分成了几个部分：

#### 2.1.1 User类
负责管理单个用户的信息，包括账号、姓名、余额等。同时处理与这个用户相关的操作，比如验证密码、进行存取款等。

#### 2.1.2 AccountManager类
管理所有用户账户，提供创建账户、查找账户、保存数据等功能。相当于整个系统的"数据库"。

#### 2.1.3 Transaction类
专门记录交易信息，包括交易类型、金额、时间等，这样可以随时查看交易历史。

#### 2.1.4 ATMSystem类
整个系统的控制中心，负责显示菜单、接收用户输入、调用相应功能。

#### 2.1.5 工具类(Utils)
放一些常用的小功能，比如生成随机账号、密码加密、输入验证等。

### 2.2 设计思路优点
- 每个类职责明确，便于后期修改
- 用户数据私有化，保证安全性
- 所有数据保存到文件，程序重启后不会丢失
- 加密密码，限制错误尝试次数

### 2.3 设计优点
- **模块化设计**：各个模块分工明确，降低了代码耦合度，便于单独测试和维护
- **易于扩展**：新的功能可以较容易地添加到现有系统中，比如增加新的交易类型
- **数据安全**：用户密码经过哈希处理后存储，即使数据文件被窃取也不会直接暴露密码
- **容错能力强**：程序在遇到异常输入时能够给出友好提示，而不是直接崩溃
- **数据持久化**：所有用户数据和交易记录都保存在文件中，即使程序关闭后数据也不会丢失
- **用户友好**：菜单式界面，操作简单明了，用户容易上手

## 3. 系统实现

### 3.1 开发过程
在实现过程中遇到了不少挑战，比如如何安全地存储密码、如何保证数据一致性等。通过查阅资料询问AI和反复测试，最终解决了这些问题。

### 3.2 使用说明

#### 3.2.1 运行程序
编译后运行程序，会看到主菜单：
```
================ATM 系统================

           1. 登录
           2. 注册
           3. 退出

=========================================
请选择（输入对应数字即可）：
```

#### 3.2.2 新用户注册
选"2. 注册"，按提示输入姓名、身份证号，设置密码。系统会自动生成一个账号。

#### 3.2.3 登录账户
选"1. 登录"，输入账号和密码。如果连续输错3次密码，账户会被锁定。

#### 3.2.4 主要功能
登录后可以选择以下功能：
- **1. 查询余额**：查看当前账户余额
- **2. 存款**：向账户存入资金
- **3. 取款**：从账户提取资金（受限额限制）
- **4. 转账**：向其他账户转账
- **5. 修改密码**：更改账户密码
- **6. 挂失/解锁账户**：挂失账户或申请解锁
- **7. 限额设置**：设置单笔或单日限额
- **8. 查看交易记录**：查看历史交易记录
- **9. 退出登录**：安全退出当前账户

### 3.3 安全措施
- 密码连续错误3次后自动锁定账户
- 设置单笔和单日交易限额
- 密码加密存储，防止泄露
- 详细记录每笔交易

## 4. 遇到的问题及解决方案

### 4.1 文件读写问题
最初在读写文件时经常出现编码错误或数据损坏，后来询问AI后了解到可以统一使用UTF-8编码，并添加了异常处理，问题得到解决。

### 4.2 密码安全
最开始直接保存明文密码，存在安全隐患。后来改用简单的哈希算法加密存储，提高了安全性.



## 5. 总结

通过这次开发，我对C++面向对象编程有了更深的理解，特别是在类的设计和模块划分方面。项目完成后感觉收获很大：

- 掌握了文件操作的基本方法
- 学会了简单的密码加密技术
- 了解了用户认证的实现原理
- 提高了代码组织能力
- 第一次完整的写一个项目，理解了类的设计思路和模块划分等知识

虽然这个系统功能还比较简单，但基本涵盖了真实ATM系统的核心功能。在开发过程中遇到的各种问题也让我学到了很多调试技巧和解决方法。

如果继续完善的话，我还想增加管理员功能、更详细的交易统计以及更好的用户界面。

## 参考资料

主要是查阅了课本还有询问AI相应的解决方法，并没有查阅其他的资料.